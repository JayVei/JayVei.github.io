document.addEventListener('DOMContentLoaded',function(){const{defaultEncoding,translateDelay,msgToTraditionalChinese,msgToSimplifiedChinese}=GLOBAL_CONFIG.translate const snackbarData=GLOBAL_CONFIG.Snackbar let currentEncoding=defaultEncoding const targetEncodingCookie='translate-chn-cht'let targetEncoding=saveToLocal.get(targetEncodingCookie)===undefined?defaultEncoding:Number(saveToLocal.get('translate-chn-cht'))let translateButtonObject,translateRightMenuButtonObject;const isSnackbar=snackbarData!==undefined function setLang(){document.documentElement.lang=targetEncoding===1?'zh-TW':'zh-CN'}function translateText(txt){if(txt===''||txt==null)return''if(currentEncoding===1&&targetEncoding===2)return Simplized(txt)else if(currentEncoding===2&&targetEncoding===1){return Traditionalized(txt)}else return txt}function translateBody(fobj){let objs if(typeof fobj==='object')objs=fobj.childNodes else objs=document.body.childNodes for(let i=0;i<objs.length;i++){const obj=objs.item(i)if('||BR|HR|'.indexOf('|'+obj.tagName+'|')>0||obj===translateButtonObject){continue}if(obj.title!==''&&obj.title!=null){obj.title=translateText(obj.title)}if(obj.alt!==''&&obj.alt!=null)obj.alt=translateText(obj.alt)if(obj.placeholder!==''&&obj.placeholder!=null){obj.placeholder=translateText(obj.placeholder)}if(obj.tagName==='INPUT'&&obj.value!==''&&obj.type!=='text'&&obj.type!=='hidden'){obj.value=translateText(obj.value)}if(obj.nodeType===3)obj.data=translateText(obj.data)else translateBody(obj)}}function translatePage(){if(targetEncoding===1){currentEncoding=1 targetEncoding=2 translateButtonObject.textContent=msgToTraditionalChinese isSnackbar&&anzhiyu.snackbarShow(snackbarData.cht_to_chs)}else if(targetEncoding===2){currentEncoding=2 targetEncoding=1 translateButtonObject.textContent=msgToSimplifiedChinese isSnackbar&&anzhiyu.snackbarShow(snackbarData.chs_to_cht)}saveToLocal.set(targetEncodingCookie,targetEncoding,2)setLang()translateBody()}function JTPYStr(){return'...'}function FTPYStr(){return'...'}function Traditionalized(cc){let str=''const ss=JTPYStr()const tt=FTPYStr()for(let i=0;i<cc.length;i++){if(cc.charCodeAt(i)>10000&&ss.indexOf(cc.charAt(i))!==-1){str+=tt.charAt(ss.indexOf(cc.charAt(i)))}else str+=cc.charAt(i)}return str}function Simplized(cc){let str=''const ss=JTPYStr()const tt=FTPYStr()for(let i=0;i<cc.length;i++){if(cc.charCodeAt(i)>10000&&tt.indexOf(cc.charAt(i))!==-1){str+=ss.charAt(tt.indexOf(cc.charAt(i)))}else str+=cc.charAt(i)}return str}function translateInitialization(){translateButtonObject=document.getElementById('translateLink');translateRightMenuButtonObject=document.getElementById('menu-translate').querySelector('span');if(translateButtonObject||translateRightMenuButtonObject){if(currentEncoding!==targetEncoding){const textContent=targetEncoding===1?msgToSimplifiedChinese:msgToTraditionalChinese;if(translateButtonObject){translateButtonObject.textContent=textContent}if(translateRightMenuButtonObject){translateRightMenuButtonObject.textContent=textContent}setLang();setTimeout(translateBody,translateDelay)}}}window.translateFn={translatePage,Traditionalized,Simplized}translateInitialization()document.addEventListener('pjax:complete',translateInitialization)})